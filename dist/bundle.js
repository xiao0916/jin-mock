!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("core-js/modules/es6.object.assign.js"),require("core-js/modules/es6.array.slice.js"),require("core-js/modules/es6.object.to-string.js"),require("core-js/modules/es6.promise.js"),require("core-js/modules/es7.promise.finally.js"),require("core-js/modules/es6.array.filter.js"),require("core-js/modules/es6.function.name.js"),require("core-js/modules/es6.array.find.js"),require("core-js/modules/es6.weak-map.js"),require("core-js/modules/es6.string.iterator.js"),require("core-js/modules/es6.array.iterator.js"),require("core-js/modules/web.dom.iterable.js"),require("core-js/modules/es6.regexp.to-string.js"),require("jquery")):"function"==typeof define&&define.amd?define(["exports","core-js/modules/es6.object.assign.js","core-js/modules/es6.array.slice.js","core-js/modules/es6.object.to-string.js","core-js/modules/es6.promise.js","core-js/modules/es7.promise.finally.js","core-js/modules/es6.array.filter.js","core-js/modules/es6.function.name.js","core-js/modules/es6.array.find.js","core-js/modules/es6.weak-map.js","core-js/modules/es6.string.iterator.js","core-js/modules/es6.array.iterator.js","core-js/modules/web.dom.iterable.js","core-js/modules/es6.regexp.to-string.js","jquery"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).jinMock={},null,null,null,null,null,null,null,null,null,null,null,null,null,e.$)}(this,(function(e,t,n,o,r,i,s,c,u,a,l,f,d,p,m){"use strict";var y=function(){};function v(){return Object.assign.apply(Object,[{}].concat(Array.prototype.slice.call(arguments)))}function j(e,t,n){return t=w(t),function(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,_()?Reflect.construct(t,[],w(e).constructor):t.apply(e,n))}function b(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function h(e,t){return e.get(function(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}(e,t))}function k(e,t,n){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,n)}function g(e,t,n){return t&&function(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,x(o.key),o)}}(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function w(e){return w=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},w(e)}function _(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(_=function(){return!!e})()}function O(e,t){return O=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},O(e,t)}function x(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}function q(e){return q="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},q(e)}function I(e){var t="function"==typeof Map?new Map:void 0;return I=function(e){if(null===e||!function(e){try{return-1!==Function.toString.call(e).indexOf("[native code]")}catch(t){return"function"==typeof e}}(e))return e;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,n)}function n(){return function(e,t,n){if(_())return Reflect.construct.apply(null,arguments);var o=[null];o.push.apply(o,t);var r=new(e.bind.apply(e,o));return n&&O(r,n.prototype),r}(e,arguments,w(this).constructor)}return n.prototype=Object.create(e.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),O(n,e)},I(e)}function C(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var E,M={exports:{}};var R=function(){if(E)return M.exports;function e(){}return E=1,e.prototype={on:function(e,t,n){var o=this.e||(this.e={});return(o[e]||(o[e]=[])).push({fn:t,ctx:n}),this},once:function(e,t,n){var o=this;function r(){o.off(e,r),t.apply(n,arguments)}return r._=t,this.on(e,r,n)},emit:function(e){for(var t=[].slice.call(arguments,1),n=((this.e||(this.e={}))[e]||[]).slice(),o=0,r=n.length;o<r;o++)n[o].fn.apply(n[o].ctx,t);return this},off:function(e,t){var n=this.e||(this.e={}),o=n[e],r=[];if(o&&t)for(var i=0,s=o.length;i<s;i++)o[i].fn!==t&&o[i].fn._!==t&&r.push(o[i]);return r.length?n[e]=r:delete n[e],this}},M.exports=e,M.exports.TinyEmitter=e,M.exports}(),S="mock:success",P="mock:fail",T="mock:cancel",F="mock:realRequest",D="mock:destroyMock",N=new(C(R));function G(e){var t,n=e.scope,o=e.status,r=e.mockId;if(!n)throw new Error("scope is required");var i=null===(t=window.__MOCK_CONFIG__)||void 0===t?void 0:t.mock;o=o||"success";var s=null,c=i[n];return c&&(s=c.filter((function(e){return e.status===o})),s=r?s.find((function(e){return e.mockId===r})):s[0]),s}function K(e,t){return"".concat(e).concat(t?"-".concat(t):"")}function z(e){var t,n=e.scope,o=e.mockId,r=e.eventId;N.emit(K(S,r),null===(t=G({scope:n,status:"success",mockId:o}))||void 0===t?void 0:t.data)}function A(e){var t,n=e.scope,o=e.mockId,r=e.eventId;N.emit(K(P,r),null===(t=G({scope:n,status:"fail",mockId:o}))||void 0===t?void 0:t.data)}function B(e){N.emit(K(T,e))}function H(e){N.emit(K(F,e))}function L(e){N.emit(K(D,e)),m("jin-mock").attr("active","false"),m("jin-mock").last().attr("active","true")}var W,$,J,Q=new WeakMap,U=function(){return g((function e(){b(this,e),k(this,Q,function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10;return Math.random().toString(36).slice(-e)}())}),[{key:"getEventId",value:function(){return h(Q,this)}},{key:"onSuccess",value:function(e,t){z({scope:e,mockId:t,eventId:h(Q,this)})}},{key:"onFail",value:function(e,t){A({scope:e,mockId:t,eventId:h(Q,this)})}},{key:"onCancel",value:function(){B(h(Q,this))}},{key:"onRealRequest",value:function(){H(h(Q,this))}},{key:"onDestroyMock",value:function(){L(h(Q,this))}}])}(),V=function(e){function t(){return b(this,t),j(this,t)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&O(e,t)}(t,e),g(t,[{key:"connectedCallback",value:function(){var e=this;this.render(),N.on(K(D,this.id),(function(){e.remove()}))}},{key:"disconnectedCallback",value:function(){this.innerHTML=""}},{key:"attributeChangedCallback",value:function(e,t,n){"active"===e&&(console.log("attributeChangedCallback",e,t,n),m(this.shadowRoot).find(".jm-container").css({display:"true"===n?"block":"none"}))}},{key:"scope",get:function(){return this._scope},set:function(e){this._scope=e}},{key:"renderDom",value:function(){var e=this,t=m('<div class="jm-container"></div>');return m(t).append(m('<div class="jm-mask"></div>\n        <div class="jm-modal">\n          <div class="jm-modal-header">\n            <h3 class="jm-modal-title">Mock 请求</h3>\n            <button class="jm-modal-close">\n              <span class="jm-modal-close-x">×</span>\n            </button>\n          </div>\n          <div class="jm-modal-body">\n          </div>\n        </div>')).find(".jm-modal-close").on("click",(function(){L(e.id)})),t}},{key:"renderStyle",value:function(){return m("<style>\n      .jm-container {\n        position: fixed;\n        top: 0;\n        left: 0;\n        width: 100%;\n        height: 100%;\n        z-index: 9999;\n      }\n      .jm-mask {\n        position: absolute;\n        top: 0;\n        left: 0;\n        width: 100%;\n        height: 100%;\n        background-color: rgba(0, 0, 0, 0.5);\n      }\n      .jm-modal {\n        position: absolute;\n        top: 50%;\n        left: 50%;\n        transform: translate(-50%, -50%);\n        width: 500px;\n        background-color: #fff;\n        box-shadow: 0 0 10px rgba(0, 0, 0, 0.5);\n      }\n      .jm-modal-header {\n        display: flex;\n        justify-content: space-between;\n        align-items: center;\n        padding: 10px;\n        background-color: #f5f5f5;\n      }\n      .jm-modal-title {\n        margin: 0;\n        font-size: 18px;\n      }\n      .jm-modal-close {\n        border: none;\n        background-color: transparent;\n        cursor: pointer;\n      }\n      .jm-modal-close-x {\n        font-size: 24px;\n        font-weight: bold;\n      }\n      .jm-modal-body {\n        padding: 10px;\n      }\n    </style>")}},{key:"render",value:function(){m(this.attachShadow({mode:"open"})).append(this.renderStyle()).append(this.renderDom())}}])}(I(HTMLElement));W=V,J=["scope","id","active"],($=x($="observedAttributes"))in W?Object.defineProperty(W,$,{value:J,enumerable:!0,configurable:!0,writable:!0}):W[$]=J;function X(e,t){var n=m("<div>"),o=m("<h3>").text("真实的请求"),r=m("<h3>").text("成功的请求"),i=m("<h3>").text("失败的请求"),s=m("<div>"),c=m("<div>"),u=m("<div>");return s.append(m("<button>").attr("type","sendRequest").data({realRequest:!0}).text("发送请求")),c.append(function(e){var t=(window.__MOCK_CONFIG__.mock||{})[e];if(t){var n=[];return null==t||t.filter((function(e){return"success"===e.status})).forEach((function(e){var t=e.mockId,o=e.name,r=m("<button>");r.attr("type","sendRequest").data({mockId:t,status:"success"}).text(t||o),n.push(r)})),n}}(e)),u.append(function(e){var t=(window.__MOCK_CONFIG__.mock||{})[e];if(t){var n=[];return null==t||t.filter((function(e){return"fail"===e.status})).forEach((function(e){var t=e.mockId,o=e.name,r=m("<button>");r.attr("type","sendRequest").data({mockId:t,status:"fail"}).text(t||o),n.push(r)})),n}}(e)),n.on("click","button[type=sendRequest]",(function(n){"fail"===m(n.target).data("status")?t.onFail(e,m(n.target).data("mockId")):"success"===m(n.target).data("status")?t.onSuccess(e,m(n.target).data("mockId")):m(n.target).data("realRequest")&&t.onRealRequest(),t.onDestroyMock()})),n.append(o).append(s).append(r).append(c).append(i).append(u),n}function Y(e){var t=new U;customElements.get("jin-mock")||customElements.define("jin-mock",V);var n,o=m("<jin-mock></jin-mock>");return o.attr("scope",e).attr("id",t.getEventId()).appendTo("body"),n=t.getEventId(),m("jin-mock").attr("active","false"),m("jin-mock[id=".concat(n,"]")).attr("active","true"),m(o.get(0).shadowRoot).find(".jm-modal-body").empty().append(X(e,t)),{eventId:t.getEventId(),close:function(){t.onDestroyMock()}}}var Z={realRequest:function(){return Promise.resolve()},enable:!0,scope:""};function ee(){var e,t=v(Z,arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}),n=t.scope,o=t.enable,r=t.realRequest;if(!n)throw new Error("scope is required");void 0===o&&(null!==(e=window.__MOCK_CONFIG__)&&void 0!==e&&e.enable,function(e){throw new TypeError('"'+e+'" is read-only')}("enable"));if(!o||o&&"object"===q(o)&&void 0!==o[n]&&!o[n])return r?r():Promise.resolve();var i=Y(n).eventId;return new Promise((function(e,t){N.on(K(S,i),(function(t){N.off(K(S,i)),e(t)})),N.on(K(P,i),(function(e){N.off(K(P,i)),t(e)})),N.on(K(T,i),(function(){N.off(K(T,i)),e("cancel")})),N.on(K(F,i),(function(){null==r||r().then(e,t).finally((function(){N.off(K(F,i))}))}))}))}var te={global:!0,mock:null,onSuccess:y,onFail:y,onCancel:y};e.createMock=function(){var e,t,n,o,r=v(te,arguments.length>0&&void 0!==arguments[0]?arguments[0]:{});return e={global:r.global,mock:r.mock,enable:r.enable},t=e.global,n=e.mock,o=e.enable,"undefined"!=typeof window&&(window.__MOCK_CONFIG__=v(window.__MOCK_CONFIG__,{global:t,mock:n,enable:o})),ee},e.onCancel=B,e.onDestroyMock=L,e.onFail=A,e.onRealRequest=H,e.onSuccess=z}));
